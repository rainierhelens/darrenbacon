const galleries = {
    'DISNEY': [
    "images/disney/SW_001i.jpg",
    "images/disney/SW_001g.jpg",
    "images/disney/SW_01-0000_00_140831_Env_ FalconGantryTunnel_v001-001_DARR.jpg",
    "images/disney/SW_dbacon_dexs_diner-03c.jpg",
    "images/disney/FILE58876.jpg",
    "images/disney/TU_TRON_underCOLISEUM_v1c.jpg",
    "images/disney/TU_recognizer_BAY_paint_2a.jpg",
    "images/disney/TU_tron_sc125_panel3_v2b_render.jpg",
    "images/disney/FILE58880.jpg",
    "images/disney/TU_Recognizer_Back_Int_v4a.jpg",
    "images/disney/TU_tron_dancefloor2_render5.jpg",
    "images/disney/TU_tron_vehicleBAY_v3b.jpg",
    "images/disney/FILE58885.jpg",
    "images/disney/TU_110712-sc323_paint_v1b.jpg",
    "images/disney/FILE58887.jpg",
    "images/disney/TU_105_cs_09v1a_color_comp_alberto03_over2a.jpg",
    "images/disney/TU_dysons_ship_paintV1b.jpg",
    "images/disney/TU_128_69_hallywayPAINT_v1c.jpg",	
    "images/disney/TU_9_sc9_dbPaint_v1f.jpg",	
    "images/disney/FILE58889.jpg",
    "images/disney/FILE58890.jpg",
    "images/disney/FILE58891.jpg",
    "images/disney/FILE58892.jpg",
    "images/disney/FILE58893.jpg",
    "images/disney/YS_2009_Sep15_00139_2_DB2h.jpg",
    "images/disney/YS_seaSnakeDB1f.jpg",
    "images/disney/YS_subInt_cam_06_v1.jpg",
    "images/disney/YS_trpRM5_13f_r1e.jpg",
    "images/disney/YS_yellowSUB_v3e_2.jpg",
    "images/disney/YS_yellowSUBover_1c.jpg",
    "images/disney/MNM_rockedFULE_6aflat.jpg",
    "images/disney/MNM_rocketship_AIRlock3d.jpg",
    "images/disney/MNM_rocket_GEARbay_v1f.jpg",
    "images/disney/MNM_rocketBAYscene4e.jpg",
    "images/disney/MNM_rocket_int_drw7x.jpg",
    "images/disney/MNM_mars_city_concept10a.jpg",
    "images/disney/MNM_gribLAIR_line2b.jpg",
    "images/disney/MNM_trainRAIL_sketch1flat.jpg",
    "images/disney/MNM_angle3AO_db1b_closedb.jpg",
    "images/disney/MNM_airLOCKdesign1d.jpg",
    "images/disney/FILE58959.jpg",
    "images/disney/FILE58960.jpg",
    "images/disney/MNM_TWOC_keyboardDB_v3a.jpg",
    "images/disney/FILE58969.jpg",
    "images/disney/MNM_mono_ckpit_intpanels01c.jpg",
    "images/disney/MNM_rocket_crash1f.jpg",

    "images/disney/FILE58981.jpg",
    "images/disney/FILE58958.jpg",
    ],
    'DEADROP': [
        "images/deadrop/deadrop1.jpg",
        "images/deadrop/deadrop2.jpg",
        "images/deadrop/deadrop3.jpg",
        "images/deadrop/deadrop4.jpg",
        "images/deadrop/deadrop5.jpg",
        "images/deadrop/deadrop6.jpg",
        "images/deadrop/deadrop7.jpg",
        "images/deadrop/deadrop8.gif",
        "images/deadrop/deadrop9.jpg",
        "images/deadrop/deadrop10.jpg",
        "images/deadrop/deadrop11.jpg",
        "images/deadrop/deadrop12.gif",
        "images/deadrop/deadrop13.jpg",
        "images/deadrop/deadrop14.jpg",
        "images/deadrop/deadrop15.jpg",
        "images/deadrop/deadrop16.jpg",
        "images/deadrop/deadrop17.jpg",
        "images/deadrop/maker_art_style_guide_3k.jpg",
        "images/deadrop/deadrop18.jpg",
        "images/deadrop/deadrop19.jpg",
        "images/deadrop/deadrop20.jpg",
        "images/deadrop/deadrop21.jpg",
        "images/deadrop/deadrop24.jpg",
        "images/deadrop/deadrop25.jpg",
        "images/deadrop/deadrop26.jpg",
        "images/deadrop/deadrop27.jpg",
        "images/deadrop/deadrop28.jpg",
        "images/deadrop/deadrop29.jpg",
        "images/deadrop/deadrop33.jpg",
        "images/deadrop/deadrop34.jpg",
        "images/deadrop/deadrop35.jpg",
        "images/deadrop/deadrop36.jpg",
        "images/deadrop/deadrop37.gif",
        "images/deadrop/deadrop38.gif",
        "images/deadrop/deadrop39.gif",
        "images/deadrop/deadrop40.jpg",
        "images/deadrop/deadrop41.gif",
        "images/deadrop/deadrop42.jpg",
        "images/deadrop/deadrop43.jpg",
        "images/deadrop/deadrop44.jpg",
        "images/deadrop/deadrop45.jpg",
        "images/deadrop/deadrop46.jpg",
        "images/deadrop/deadrop47.jpg",
        "images/deadrop/deadrop48.jpg"
    ],
    'HALO': [
        "images/halo/halo1.jpg",
        "images/halo/halo2.jpg",
        "images/halo/halo3.jpg",
        "images/halo/halo3-2.jpg",
        "images/halo/halo4.jpg",
        "images/halo/halo5.jpg",
        "images/halo/halo6.jpg",
        "images/halo/halo20.jpg",
        "images/halo/halo7.jpg",
        "images/halo/halo8.jpg",
        "images/halo/halo9.jpg",
        "images/halo/halo10.jpg",
        "images/halo/halo11.jpg",
        "images/halo/halo12.jpg",
        "images/halo/halo13.jpg",
        "images/halo/halo14.jpg",
        "images/halo/halo15.jpg",
        "images/halo/halo16.jpg",
        "images/halo/halo17.jpg",
        "images/halo/halo18.jpg",
        "images/halo/halo19.jpg",
        "images/halo/halo21.jpg",
        "images/halo/halo22.jpg",
        "images/halo/halo26.jpg",
        "images/halo/halo27.jpg",
        "images/halo/halo28.jpg",
        "images/halo/halo29.jpg",
        "images/halo/halo30.jpg",
        "images/halo/halo31.jpg",
        "images/halo/halo32.jpg",
        "images/halo/halo33.jpg",
        "images/halo/halo34.jpg",
        "images/halo/halo35.jpg",
        "images/halo/halo36.jpg",
        "images/halo/halo37.jpg",
        "images/halo/halo39.jpg",
        "images/halo/halo40.jpg",
        "images/halo/halo41.jpg",
        "images/halo/halo42.jpg",
        "images/halo/halo43.jpg",
        "images/halo/halo44.jpg",
        "images/halo/halo45.jpg",
    ],
    'DESTINY': [
        "images/destiny/destiny1.jpg",
        "images/destiny/destiny2.jpg",
        "images/destiny/destiny3.jpg",
        "images/destiny/destiny4.jpg",
        "images/destiny/destiny5.jpg",
        "images/destiny/destiny6.jpg",
        "images/destiny/destiny7.jpg",
        "images/destiny/destiny8.jpg",
        "images/destiny/destiny9.jpg",
        "images/destiny/destiny10.jpg",
        "images/destiny/destiny11.jpg",
        "images/destiny/destiny12.jpg",
        "images/destiny/destiny13.jpg",
        "images/destiny/destiny14.JPG",
        "images/destiny/destiny15.JPG",
        "images/destiny/destiny16.JPG",
        "images/destiny/destiny17.JPG",
        "images/destiny/destiny18.JPG",
        "images/destiny/destiny19.jpg",
        "images/destiny/destiny20.jpg",
        "images/destiny/destiny21.jpg",
        "images/destiny/destiny22.jpg",
        "images/destiny/destiny23.jpg",
        "images/destiny/destiny24.jpg",
        "images/destiny/destiny25.jpg",
        "images/destiny/destiny26.jpg",
        "images/destiny/destiny27.jpg",
        "images/destiny/destiny28.jpg",
        "images/destiny/destiny29.jpg",
        "images/destiny/destiny30.jpg",
        "images/destiny/tumblr_p2gd6iTRSc1rqvckio1_1280.jpg",
    ],
    'OTHER': [
        "images/other/dbacon_BEM_mad_max-1E_onesheet4k.jpg",
        "images/other/dbacon_BE_jamesbond_4k-2.jpg",
        "images/other/unnamed.jpg",
        "images/other/Kovalai_Vector_Refinery.jpg",
        "images/other/rover_1_sketch.jpg",
        "images/other/space_soldier.jpg",
        "images/other/tumblr_ojw22b2srD1rqvckio1_1280.jpg",
        "images/other/tumblr_ol72kzhins1rqvckio1_1280.jpg",
        "images/other/tumblr_oqkhthIkGe1rqvckio1_1280.jpg",
        "images/other/tumblr_pg31ymAguW1rqvckio1_1280.jpg",
        "images/other/tumblr_pg31ymAguW1rqvckio2_1280.jpg",
        "images/other/tumblr_ppiupnrqV51qeldhr_1280.jpg",
        "images/other/tumblr_oi8ohlz61a1rqvckio1_1280.jpg",
        "images/other/tumblr_phqbbfCIkK1rqvckio2_1280.jpg",
        "images/other/tumblr_phqbbfCIkK1rqvckio3_1280.jpg",
        "images/other/tumblr_nm35a3jtgU1rqvckio1_1280.jpg",
        "images/other/tumblr_phqbbfCIkK1rqvckio5_1280.jpg",
        "images/other/tumblr_phqbbfCIkK1rqvckio6_1280.jpg",
        "images/other/tumblr_o96p6sJm1x1rqvckio3_400.webp",
        "images/other/tumblr_o9e6qtdMUT1rqvckio1_400.webp",
        "images/other/tumblr_o7wchuENY51rqvckio1_1280.jpg",
        "images/other/tumblr_o5fxmaFRTy1rqvckio1_1280.jpg",
        "images/other/tumblr_o03op1khMs1rqvckio1_1280.jpg",
        "images/other/tumblr_o2juektf2p1rqvckio1_1280.jpg",
        "images/other/tumblr_o0inwz4HTr1rqvckio1_1280.jpg",
        
        "images/other/tumblr_n202yxvnx91rqvckio1_1280.jpg",
        "images/other/tumblr_n202yxvnx91rqvckio2_1280.jpg",
        
        "images/other/tumblr_ozxs8hwdFT1rqvckio2_1280.jpg",
        
        "images/other/RR_bedside_shot-overrender01a-3K.jpg",
        "images/other/RR_mWARDproj_sketches01-a-sm.jpg",
        "images/other/RR_mWARDproj_sketches02-c.jpg",
        "images/other/RR_reapers_05a.jpg",
        "images/other/RR_dbacon_Reaping_Angel_paint1a.jpg",
      
    ],
    'HALO_INFINITE': [
        "images/ad-halo/halo-ad-1.jpg",
        "images/ad-halo/halo-ad-2.jpg",
        "images/ad-halo/halo-ad-3.jpg",
        "images/ad-halo/halo-ad-4.jpg",
        "images/ad-halo/halo-ad-5.jpg",
        "images/ad-halo/halo-ad-6.jpg",
        "images/ad-halo/halo-ad-7.jpg",
        "images/ad-halo/halo-ad-8.jpg",
        "images/ad-halo/halo-ad-9.jpg",
        "images/ad-halo/halo-ad-10.jpg",
        "images/ad-halo/halo-ad-11.jpg",
        "images/ad-halo/halo-ad-12.jpg",
        "images/ad-halo/halo-ad-13.jpg",
        "images/ad-halo/halo-ad-14.jpg",
        "images/ad-halo/halo-ad-15.jpg",
        "images/ad-halo/halo-ad-16.jpg",
        "images/ad-halo/halo-ad-17.jpg",
        "images/ad-halo/halo-ad-18.jpg",
        "images/ad-halo/halo-ad-19.jpg",
        "images/ad-halo/halo-ad-20.jpg",
        "images/ad-halo/frag1_BEFORE-AFTER.jpg",
        "images/ad-halo/frag2_BEFORE-AFTER.jpg",
        "images/ad-halo/Game _ 18228 _ W_24024 _ T_2333 2_4_2021 8_55_48 PM-BEFORE-AFTER.jpg",
        "images/ad-halo/interlock_visual_target_BEFORE-AFTER.jpg",
        "images/ad-halo/rockridge_vis_target_BEFORE-AFTER.jpg",
        "images/ad-halo/screenshot06-POc-4k-2-BEFORE-AFTER.jpg",
        "images/ad-halo/halo-ad-21.jpg",
        "images/ad-halo/halo-ad-22.jpg",
        "images/ad-halo/halo-ad-23.jpg",
        "images/ad-halo/halo-ad-24.jpg",
        "images/ad-halo/halo-ad-25.jpg",
        "images/ad-halo/halo-ad-26.jpg",
    ],
    'HALO_STYLE_GUIDE': [
        "images/halo-styleguide/Infinite_Art_Index_v0.6b.pdf",
    ],
    'SEASONAL_VISION': [
        "images/seasonal-vision/seasonal_theme_deck-1g.pdf",
    ]
};

let currentGallery = 'HALO';
let currentImageIndex = 0;
let lastScrollY = 0;
let pdfDoc = null; // PDF document object
let haloStyleGuidePageNum = 1; // Current page for Halo Style Guide
let seasonalVisionPageNum = 1; // Current page for Seasonal Vision
let currentScale = 2.0; // Fixed scale for PDF view

const scrollToTop = () => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
};

const loadGallery = (type) => {
    currentGallery = type;
    const projectXGallery = document.getElementById('project-x-gallery');
    const projectYViewer = document.getElementById('project-y-viewer');
    const standardGallery = document.getElementById('standard-gallery');
    const conceptGallery = document.getElementById('concept-gallery');
    const gameplaySection = document.getElementById('gameplay-section');

    const isConceptActive = document.getElementById('concept-gallery-section').classList.contains('active');
    const targetGallery = isConceptActive ? conceptGallery : standardGallery;

    if (!isConceptActive) {
        projectXGallery.style.display = 'none';
        projectYViewer.style.display = 'none';
        standardGallery.style.display = 'grid';
        gameplaySection.style.display = 'none';
        if (type === 'SEASONAL_VISION') {
            loadSeasonalVisionViewer();
            return;
        }
    } else {
        projectXGallery.style.display = 'none';
        projectYViewer.style.display = 'none';
        standardGallery.style.display = 'none';
        conceptGallery.style.display = 'grid';
        gameplaySection.style.display = 'none';
    }

    targetGallery.innerHTML = '';
    
    document.querySelectorAll('.gallery-tabs button').forEach(btn => btn.classList.remove('active'));
    const activeButton = document.querySelector(`.gallery-tabs button[data-type="${type}"]`);
    if (activeButton) activeButton.classList.add('active');

    galleries[type].forEach((imgSrc, index) => {
        const link = document.createElement('a');
        link.href = '#';
        link.onclick = (event) => {
            event.preventDefault();
            openLightbox(index);
        };
        const img = document.createElement('img');
        img.src = imgSrc;
        img.classList.add('gallery-item');
        img.loading = 'lazy'; // Add lazy loading attribute
        img.onload = () => img.classList.add('loaded');
        link.appendChild(img);
        targetGallery.appendChild(link);
    });

    // Update the active state of the main gallery buttons
    updateMainGalleryButtonState();
}

const loadProjectXGallery = () => {
    currentGallery = 'HALO_INFINITE';
    const projectXGallery = document.getElementById('project-x-gallery');
    const projectYViewer = document.getElementById('project-y-viewer');
    const standardGallery = document.getElementById('standard-gallery');
    const gameplaySection = document.getElementById('gameplay-section');
    
    projectXGallery.style.display = 'flex';
    projectYViewer.style.display = 'none';
    standardGallery.style.display = 'none';
    gameplaySection.style.display = 'none';
    
    projectXGallery.innerHTML = '';
    
    document.querySelectorAll('.gallery-tabs button').forEach(btn => btn.classList.remove('active'));
    document.querySelector('.gallery-tabs button[data-type="HALO_INFINITE"]').classList.add('active');
    
    galleries['HALO_INFINITE'].forEach((imgSrc, index) => {
        const img = document.createElement('img');
        img.src = imgSrc;
        img.alt = `Halo Infinite Image ${index + 1}`;
        img.loading = 'lazy'; // Add lazy loading attribute
        img.onclick = () => openLightbox(index);
        projectXGallery.appendChild(img);
    });

    // Update the active state of the main gallery buttons
    updateMainGalleryButtonState();
}

const loadProjectYViewer = (type) => {
    currentGallery = type;
    const projectXGallery = document.getElementById('project-x-gallery');
    const projectYViewer = document.getElementById('project-y-viewer');
    const standardGallery = document.getElementById('standard-gallery');
    const gameplaySection = document.getElementById('gameplay-section');
    
    projectXGallery.style.display = 'none';
    projectYViewer.style.display = 'block';
    standardGallery.style.display = 'none';
    gameplaySection.style.display = 'none';
    
    projectYViewer.innerHTML = `
        <div class="pdf-controls">
            <button id="prev-page">Previous</button>
            <span id="page-num">Page 1</span> of <span id="page-count"></span>
            <button id="next-page">Next</button>
        </div>
        <canvas id="pdf-canvas"></canvas>
    `;
    
    document.querySelectorAll('.gallery-tabs button').forEach(btn => btn.classList.remove('active'));
    document.querySelector(`.gallery-tabs button[data-type="${type}"]`).classList.add('active');
    
    const pdfUrl = galleries[type][0];
    pdfjsLib.getDocument(pdfUrl).promise.then(function(pdf) {
        pdfDoc = pdf;
        document.getElementById('page-count').textContent = pdf.numPages;
        renderPage(type === 'HALO_STYLE_GUIDE' ? haloStyleGuidePageNum : seasonalVisionPageNum);

        const pdfControls = document.querySelector('.pdf-controls');
        if (pdfControls) {
            pdfControls.addEventListener('click', (event) => {
                const target = event.target;
                if (target.id === 'prev-page') {
                    changePage(-1);
                } else if (target.id === 'next-page') {
                    changePage(1);
                }
            });
        } else {
            console.error('PDF controls container not found');
        }
    }).catch(function(error) {
        console.error('Error loading PDF:', error);
        projectYViewer.innerHTML = '<p>Failed to load PDF.</p>';
    });

    // Update the active state of the main gallery buttons
    updateMainGalleryButtonState();
}

const loadSeasonalVisionViewer = () => {
    currentGallery = 'SEASONAL_VISION';
    const projectXGallery = document.getElementById('project-x-gallery');
    const projectYViewer = document.getElementById('project-y-viewer');
    const standardGallery = document.getElementById('standard-gallery');
    const gameplaySection = document.getElementById('gameplay-section');
    
    projectXGallery.style.display = 'none';
    projectYViewer.style.display = 'block';
    standardGallery.style.display = 'none';
    gameplaySection.style.display = 'none';
    
    projectYViewer.innerHTML = `
        <div class="pdf-controls">
            <button id="prev-page">Previous</button>
            <span id="page-num">Page 1</span> of <span id="page-count"></span>
            <button id="next-page">Next</button>
        </div>
        <canvas id="pdf-canvas"></canvas>
    `;
    
    document.querySelectorAll('.gallery-tabs button').forEach(btn => btn.classList.remove('active'));
    document.querySelector('.gallery-tabs button[data-type="SEASONAL_VISION"]').classList.add('active');
    
    const pdfUrl = galleries['SEASONAL_VISION'][0];
    pdfjsLib.getDocument(pdfUrl).promise.then(function(pdf) {
        pdfDoc = pdf;
        document.getElementById('page-count').textContent = pdf.numPages;
        renderPage(seasonalVisionPageNum);

        const pdfControls = document.querySelector('.pdf-controls');
        if (pdfControls) {
            pdfControls.addEventListener('click', (event) => {
                const target = event.target;
                if (target.id === 'prev-page') {
                    changePage(-1);
                } else if (target.id === 'next-page') {
                    changePage(1);
                }
            });
        } else {
            console.error('PDF controls container not found');
        }
    }).catch(function(error) {
        console.error('Error loading PDF:', error);
        projectYViewer.innerHTML = '<p>Failed to load PDF.</p>';
    });

    // Update the active state of the main gallery buttons
    updateMainGalleryButtonState();
}

const renderPage = (pageNum) => {
    if (!pdfDoc) return;
    const currentPageNum = currentGallery === 'HALO_STYLE_GUIDE' ? haloStyleGuidePageNum : seasonalVisionPageNum;
    const newPageNum = Math.min(Math.max(1, pageNum), pdfDoc.numPages);
    if (currentGallery === 'HALO_STYLE_GUIDE') {
        haloStyleGuidePageNum = newPageNum;
    } else {
        seasonalVisionPageNum = newPageNum;
    }
    document.getElementById('page-num').textContent = `Page ${newPageNum}`;
    
    pdfDoc.getPage(newPageNum).then((page) => {
        const canvas = document.getElementById('pdf-canvas');
        const context = canvas.getContext('2d');
        const viewport = page.getViewport({ scale: currentScale });
        
        canvas.width = viewport.width;
        canvas.height = viewport.height;

        const renderContext = {
            canvasContext: context,
            viewport: viewport
        };
        page.render(renderContext);
    }).catch((error) => {
        console.error('Error rendering page:', error);
    });
}

const changePage = (direction) => {
    if (!pdfDoc) return;
    const currentPageNum = currentGallery === 'HALO_STYLE_GUIDE' ? haloStyleGuidePageNum : seasonalVisionPageNum;
    const newPageNum = currentPageNum + direction;
    if (newPageNum >= 1 && newPageNum <= pdfDoc.numPages) {
        renderPage(newPageNum);
    }
}

const openLightbox = (index) => {
    if (currentGallery === 'HALO_STYLE_GUIDE' || currentGallery === 'SEASONAL_VISION') return;
    currentImageIndex = index;
    const lightbox = document.getElementById('lightbox');
    lightbox.style.display = 'flex';
    document.getElementById('lightbox-image').src = galleries[currentGallery][index];
}

const closeLightbox = () => {
    const lightbox = document.getElementById('lightbox');
    if (lightbox) {
        lightbox.style.display = 'none';
    } else {
        console.error('Lightbox not found!');
    }
}

const navigateLightbox = (direction) => {
    if (currentGallery === 'HALO_STYLE_GUIDE' || currentGallery === 'SEASONAL_VISION') return;
    currentImageIndex = (currentImageIndex + direction + galleries[currentGallery].length) % galleries[currentGallery].length;
    const lightboxImage = document.getElementById('lightbox-image');
    if (lightboxImage) {
        lightboxImage.src = galleries[currentGallery][currentImageIndex];
    } else {
        console.error('Lightbox image not found!');
    }
}

function switchGallery(galleryType) {
    // Hide all gallery sections
    document.querySelectorAll('.gallery-section').forEach(section => {
        section.classList.remove('active');
    });

    // Show the selected gallery section
    document.getElementById(`${galleryType}-gallery-section`).classList.add('active');

    // Remove active class from all buttons
    document.querySelectorAll('.gallery-category button').forEach(button => {
        button.classList.remove('active');
    });

    // Add active class to the selected button
    document.querySelector(`button[data-type="${galleryType.toUpperCase()}"]`).classList.add('active');

    // Hide gameplay section
    document.getElementById('gameplay-section').style.display = 'none';

    // Load Halo Infinite gallery if Art Direction Samples is selected
    if (galleryType === 'art-direction') {
        loadProjectXGallery();
    } else {
        // Load the first gallery in the Concept Samples by default
        loadGallery('HALO');
    }
}

function loadGameplay() {
    // Hide other sections
    document.getElementById('project-x-gallery').style.display = 'none';
    document.getElementById('project-y-viewer').style.display = 'none';
    document.getElementById('gameplay-section').style.display = 'block';

    // Remove active class from other buttons
    document.querySelectorAll('.gallery-tabs button').forEach(button => {
        button.classList.remove('active');
    });

    // Add active class to the Gameplay button
    document.querySelector('button[data-type="GAMEPLAY"]').classList.add('active');
}

function updateMainGalleryButtonState() {
    const conceptSamplesBtn = document.getElementById('concept-samples-btn');
    const artDirectionSamplesBtn = document.getElementById('art-direction-samples-btn');

    if (document.getElementById('concept-gallery-section').classList.contains('active')) {
        conceptSamplesBtn.classList.add('active');
        artDirectionSamplesBtn.classList.remove('active');
    } else if (document.getElementById('art-direction-gallery-section').classList.contains('active')) {
        conceptSamplesBtn.classList.remove('active');
        artDirectionSamplesBtn.classList.add('active');
    }
}

document.addEventListener('DOMContentLoaded', function() {
    const menuToggle = document.querySelector('.menu-toggle');
    const mobileNav = document.querySelector('.mobile-nav');
    const backToTopButton = document.getElementById('backToTop');

    if (!menuToggle || !mobileNav) {
        console.error('Menu toggle or mobile nav not found!');
        return;
    }

    menuToggle.addEventListener('click', function() {
        console.log('Menu toggle clicked');
        mobileNav.classList.toggle('active');
        console.log('Mobile nav class list:', mobileNav.classList);
        console.log('Mobile nav style:', window.getComputedStyle(mobileNav).display);
    });

    document.addEventListener('click', function(event) {
        if (!mobileNav.contains(event.target) && !menuToggle.contains(event.target) && mobileNav.classList.contains('active')) {
            console.log('Closing mobile nav');
            mobileNav.classList.remove('active');
        }
    });

    // Show or hide the "Back to Top" button based on scroll position
    window.addEventListener('scroll', function() {
        if (window.scrollY > 300) {
            backToTopButton.style.display = 'block';
        } else {
            backToTopButton.style.display = 'none';
        }
    });

    // Load HALO gallery by default
    loadGallery('HALO');
    updateMainGalleryButtonState();
});

// Close lightbox when clicking outside the image
const lightbox = document.getElementById('lightbox');
if (lightbox) {
    lightbox.addEventListener('click', function(event) {
        if (event.target === this) {
            closeLightbox();
        }
    });
} else {
    console.error('Lightbox not found!');
}

function debounce(func, wait) {
    let timeout;
    return function(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

document.addEventListener('keydown', (event) => {
    if (event.key === 'Escape') {
        closeLightbox();
    } else if (event.key === 'ArrowRight' && currentGallery !== 'HALO_STYLE_GUIDE' && currentGallery !== 'SEASONAL_VISION') {
        navigateLightbox(1);
    } else if (event.key === 'ArrowLeft' && currentGallery !== 'HALO_STYLE_GUIDE' && currentGallery !== 'SEASONAL_VISION') {
        navigateLightbox(-1);
    }
});